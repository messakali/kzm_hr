<?xml version="1.0" encoding="UTF-8" ?>
<openerp>
    <data>
        <!-- Expense main menu -->
        <record id="hr_expense.menu_hr_expense_root" model="ir.ui.menu">
            <field eval="[(6, 0, [ref('group_hr_menu_expense')])]" name="groups_id"/>
        </record>
        <!-- Expense form -->
        <record id="view_hr_expense_expense_payroll_form" model="ir.ui.view">
            <field name="name">hr.expense.form</field>
            <field name="model">hr.expense</field>
            <field name="inherit_id" ref="hr_expense.hr_expense_form_view"/>
            <field name="arch" type="xml">
                <xpath expr="//button[@name='submit_expenses']" position="after">
                    <button class="oe_highlight" groups="hr.group_hr_manager" name="payroll_done"
                        states="accepted" string="Report to payroll" type="workflow"/>
                    <button groups="hr.group_hr_manager" name="expense_force_paid"
                        states="done" string="Mark as paid" type="workflow"/>
                </xpath>
                <xpath expr="//field[@name='date']" position="after">
                    <field name="payroll_date"/>
                </xpath>
            </field>
        </record>
        <!-- Expense Filter -->
        <record id="view_hr_payroll_expense_filter" model="ir.ui.view">
            <field name="name">hr.expense.filter</field>
            <field name="model">hr.expense</field>
            <field name="inherit_id" ref="hr_expense.view_hr_expense_filter"/>
            <field name="arch" type="xml">
                <xpath expr="//separator[1]" position="after">
                    <filter domain="[('payroll_ok','=',True),('state','in',['done','paid'])]"
                        help="Notes de frais reported to the payroll" icon="terp-dolar" string="Reported to the payroll"/>
                    <filter domain="[('payroll_ok','=',False),('state','in',['done','paid'])]"
                        help="Notes de frais invoiced" icon="terp-dolar" string="Direct voucher"/>
                    <separator/>
                </xpath>
            </field>
        </record>
        <!-- Expense Context for employee Form -->
        <record id="act_open_hr_expense_view_context" model="ir.actions.act_window">
            <field name="name">Notes de frais</field>
            <field name="type">ir.actions.act_window</field>
            <field name="res_model">hr.expense</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,form</field>
            <field name="domain">[('employee_id','=',active_id)]</field> <field
                name="context">{'search_default_employee_id': [active_id],
                'default_employee_id': active_id}</field>
        </record>
    </data>
</openerp>
