<?xml version="1.0" encoding="UTF-8" ?>
<openerp>
    <data>
        <record id="view_hr_voucher_order_tree" model="ir.ui.view">
            <field name="name">hr.voucher.order.tree</field>
            <field name="model">hr.voucher.order</field>
            <field name="type">tree</field>
            <field  eval="8" name="priority"/>
            <field name="arch" type="xml">
                <tree colors="grey:state in ['cancel','done'] ; blue:state=='draft'" string="Règlements">
                    <field  name="name"/>
                    <field  name="ref"/>
                    <field  name="fiscalyear_id"/>
                    <field  name="period_id"/>
                    <field  name="date_from"/>
                    <field  name="date_to"/>
                    <field  name="bank_id"/>
                    <field  name="state"/>
                </tree>
            </field>
        </record>
        <record id="view_hr_voucher_order_form" model="ir.ui.view">
            <field name="name">hr.voucher.order.form</field>
            <field name="model">hr.voucher.order</field>
            <field name="type">form</field>
            <field  eval="8" name="priority"/>
            <field name="arch" type="xml">
                <form string="Règlements">
                    <header>
                        <button  class="oe_highlight" name="load" states="draft" string="Recharger les lignes" type="object"/>
                        <button  name="voucher_refuse1" states="draft" string="Annuler" type="workflow"/>
                        <button  class="oe_highlight" name="voucher_done" states="draft" string="Fermer" type="workflow"/>
                        <button  name="voucher_refuse2" states="done" string="Annuler" type="workflow"/>
<!-- <button class="oe_highlight" name="voucher_reset" states="cancel" string="Remettre en brouillon" type="workflow"/> -->
<!-- <button name="action_print_pdf" string="Print PDF" type="object"/> -->
<!-- <button name="action_generate_xls" string="Generate XLS" type="object"/> -->
                        <field  name="state" statusbar_visible="draft,done" widget="statusbar"/>
                    </header>
                    <sheet>
                        <div class="oe_button_box" name="button_box">
                            <button class="oe_stat_button" icon="fa-list" name="open_es_slips" type="object" attrs="{'invisible': [('espece','=', False)]}">
                                <field name="count_es_line_ids" string="Espèces" widget="statinfo"/>
                            </button>
                            <button class="oe_stat_button" icon="fa-list" name="open_ch_slips" type="object" attrs="{'invisible': [('cheque','=', False)]}">
                                <field name="count_ch_line_ids" string="Chèques" widget="statinfo"/>
                            </button>
                            <button class="oe_stat_button" icon="fa-list" name="open_vir_slips" type="object" attrs="{'invisible': [('virement','=', False)]}">
                                <field name="count_vir_line_ids" string="Virement" widget="statinfo"/>
                            </button>
                        </div>
                        <group col="4" colspan="4">
                            <group colspan="2" name="general">
                                <label  for="fiscalyear_id" string="Période"/>
                                <div>
                                    <field  class="oe_inline" groups="l10n_ma_hr_payroll.group_paie_interface_helper" name="fiscalyear_id" required="0"
                                        widget="selection"/>
                                    -
                                    <field  class="oe_inline" domain="[('type_id.name','=',time.strftime('%Y')),('active','=',True)]"
                                        groups="l10n_ma_hr_payroll.group_paie_interface_helper" name="period_id" required="0" widget="selection"/>
                                </div>

                                <label  for="date_from" string="Période"/>
                                <div>
                                    <field  class="oe_inline" name="date_from" required="1"/>
                                    -
                                    <field  class="oe_inline" name="date_to" required="1"/>
                                </div>
                                <field  name="source"/>
                                <field  name="voucher_date"/>
                                <field  groups="l10n_ma_hr_payroll.group_paie_interface_state" name="payslip_state" attrs="{'invisible': [('source','!=', 'slip')]}"/>
                                <field  name="bank_id" widget="selection"/>
                            </group>
                            <group colspan="2" name="types" string="Modes de règlement">
                                <field  name="espece"/>
                                <field  name="cheque"/>
                                <field  name="virement"/>
                            </group>
                            <group colspan="2" name="params" string="Paramètres">
                                <field  name="name"/>
                                <field  name="ref"/>
                                <field  groups="base.group_multi_company" name="company_child" required="0"/>
                                <field  groups="base.group_multi_company" name="company_parent" required="0"/>
                            </group>
                            <group colspan="2" groups="l10n_ma_hr_payroll.group_paie_interface_department" name="department">
                                <div class="style_department">
                                    <separator  string="Limiter les départements"/>
                                    <field  name="departments_id" widget="many2many_checkboxes"/>
                                </div>
                            </group>
                        </group>
                        <group colspan="4" groups="base.group_multi_company">
                            <div class="style_company">
                                <separator  colspan="4" string="Sociétés"/>
                                <field  colspan="4" name="company_ids" nolabel="1" widget="many2many_tags"/>
                            </div>
                        </group>
                        <notebook colspan="4">
                            <page invisible="1" string="Lines">
                                <field colspan="4" name="line_ids" nolabel="1">
                                    <tree editable="bottom" string="Lines">
                                        <field  name="name"/>
                                        <field  name="employee_id"/>
                                        <field  name="slip_id"/>
                                        <field  name="avance_line_id"/>
                                        <field  name="bank_id"/>
                                        <field  name="voucher_mode"/>
                                        <field  name="amount" sum="Total à payer"/>
                                    </tree>
                                </field>
                            </page>
                            <page attrs="{'invisible': [('espece','=', False)]}" string="Espèces">
                                <field colspan="4" name="es_line_ids" nolabel="1">
                                    <tree editable="bottom" string="Espèces">
                                        <field  name="name"/>
                                        <field  name="employee_id"/>
                                        <field  name="slip_id"/>
                                        <field  name="avance_line_id"/>
                                        <field  name="bank_id"/>
                                        <field  name="voucher_mode"/>
                                        <field  name="amount" sum="Total à payer"/>
                                    </tree>
                                </field>
                            </page>
                            <page attrs="{'invisible': [('cheque','=', False)]}" string="Chèque">
                                <field colspan="4" name="ch_line_ids" nolabel="1">
                                    <tree editable="bottom" string="Chèque">
                                        <field  name="name"/>
                                        <field  name="employee_id"/>
                                        <field  name="slip_id"/>
                                        <field  name="avance_line_id"/>
                                        <field  name="bank_id"/>
                                        <field  name="voucher_mode"/>
                                        <field  name="amount" sum="Total à payer"/>
                                    </tree>
                                </field>
                            </page>
                            <page attrs="{'invisible': [('virement','=', False)]}" string="Virement">
                                <field colspan="4" name="vir_line_ids" nolabel="1">
                                    <tree editable="bottom" string="Virement">
                                        <field  name="name"/>
                                        <field  name="employee_id"/>
                                        <field  name="slip_id"/>
                                        <field  name="avance_line_id"/>
                                        <field  name="bank_id"/>
                                        <field  name="voucher_mode"/>
                                        <field  name="amount" sum="Total à payer"/>
                                    </tree>
                                </field>
                            </page>
                        </notebook>
                    </sheet>
                </form>
            </field>
        </record>
        <record id="view_hr_voucher_order_search" model="ir.ui.view">
            <field name="name">hr.voucher.order.search</field>
            <field name="model">hr.voucher.order</field>
            <field name="type">search</field>
            <field  eval="8" name="priority"/>
            <field name="arch" type="xml">
                <search string="Règlements">
                    <field  name="fiscalyear_id" select="True"/>
                    <field  name="period_id" select="True"/>
                </search>
            </field>
        </record>
        <record id="act_open_hr_voucher_order_view" model="ir.actions.act_window">
            <field name="name">Règlements</field>
            <field name="type">ir.actions.act_window</field>
            <field name="res_model">hr.voucher.order</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,form</field>
            <field  name="search_view_id" ref="view_hr_voucher_order_search"/>
            <field name="domain">[]</field>
            <field name="context">{}</field>
        </record>
        <record id="act_open_hr_voucher_order_view_form" model="ir.actions.act_window.view">
            <field  name="act_window_id" ref="act_open_hr_voucher_order_view"/>
            <field  eval="20" name="sequence"/>
            <field name="view_mode">form</field>
            <field  name="view_id" ref="view_hr_voucher_order_form"/>
        </record>
        <record id="act_open_hr_voucher_order_view_tree" model="ir.actions.act_window.view">
            <field  name="act_window_id" ref="act_open_hr_voucher_order_view"/>
            <field  eval="10" name="sequence"/>
            <field name="view_mode">tree</field>
            <field  name="view_id" ref="view_hr_voucher_order_tree"/>
        </record>
        <menuitem  action="act_open_hr_voucher_order_view" groups="l10n_ma_hr_payroll.group_hr_menu_voucher" id="menu_hr_voucher_order"
            parent="l10n_ma_hr_payroll.menu_hr_main_accounting" sequence="16"/>
    </data>
</openerp>
